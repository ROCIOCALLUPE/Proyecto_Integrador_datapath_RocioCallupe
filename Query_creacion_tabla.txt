
CREATE TABLE Dim_Brokers
AS
SELECT 
[BrokerID],
[BrokerName],
[Region],
[Email]
FROM  [LKH_PROY_INTEGRADOR_RCALL].[dbo].[brokers]

GO

SELECT * FROM Dim_Brokers 


CREATE TABLE Dim_campaigns (
    campaignID      INT            NOT NULL,
    Channel         VARCHAR(50)   NULL,
    CampaignName    VARCHAR(50)   NULL
);


INSERT INTO Dim_campaigns
select distinct campaignID,Channel,CampaignName from LKH_PROY_INTEGRADOR_RCALL.dbo.campaigns 

select top 10 * from Dim_campaigns


CREATE TABLE Dim_clients
AS
SELECT  [ClientID],
			[FirstName],
			[LastName],
			[Email],
			[Region]
FROM [LKH_PROY_INTEGRADOR_RCALL].[dbo].[clients]

CREATE TABLE Dim_projects
AS

SELECT   [ProjectID],
			[ProjectName],
			[City],
			[Region],
			[LaunchYear],
			[Status]
FROM [LKH_PROY_INTEGRADOR_RCALL].[dbo].[projects]

CREATE TABLE Dim_Tiempo
AS

SELECT  [FechaID],
			[Fecha],
			[Anio],
			[nuMes],
			[nombre_mes],
			[semana_anio],
			[Semana_mes],
			[nuDia],
			[nombre_dia]
FROM [LKH_PROY_INTEGRADOR_RCALL].[dbo].[tiempo]



create TABLE Dim_properties
AS
SELECT  [PropertyID],
			[ProjectID],
			[PropertyType],
			[Size_m2],
			[Bedrooms],
			[Bathrooms],
			[ListPriceUSD],
			[AvailabilityStatus]
FROM [LKH_PROY_INTEGRADOR_RCALL].[dbo].[properties]


CREATE TABLE Fact_leads
AS
SELECT distinct [LeadID],
			[ClientID],
			[PropertyID],
			[ListPriceUSD],
			[CampaignID],
			[BudgetUSD],
			[LeadDate],
			[LeadSource],
			[idLeadDate]
FROM [LKH_PROY_INTEGRADOR_RCALL].[dbo].[leads]


CREATE TABLE Fact_Sales
AS
SELECT distinct [SaleID],
			[ClientID],
			[PropertyID],
			[ListPriceUSD],
			[BrokerID],
			[SaleDate],
			[SalePriceUSD],
			[idSaleDate]
FROM [LKH_PROY_INTEGRADOR_RCALL].[dbo].[sales]


insert into Fact_Sales
SELECT distinct [SaleID],
			[ClientID],
			[PropertyID],
			[ListPriceUSD],
			[BrokerID],
			[SaleDate],
			[SalePriceUSD],
			[idSaleDate]
FROM [LKH_PROY_INTEGRADOR_RCALL].[dbo].[sales]


insert into Fact_leads

SELECT distinct [LeadID],
			[ClientID],
			[PropertyID],
			[ListPriceUSD],
			[CampaignID],
			[BudgetUSD],
			[LeadDate],
			[LeadSource],
			[idLeadDate]
FROM [LKH_PROY_INTEGRADOR_RCALL].[dbo].[leads]



